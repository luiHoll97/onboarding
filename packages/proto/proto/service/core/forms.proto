syntax = "proto3";

package service.core.forms;

message CreatePrefilledFormLinkRequest {
  string provider = 1;
  string form_id = 2;
  map<string, string> prefill_fields = 3;
}

message CreatePrefilledFormLinkResponse {
  string prefilled_url = 1;
  string qr_code_url = 2;
}

message SendFormInvitationRequest {
  string provider = 1;
  string form_id = 2;
  map<string, string> prefill_fields = 3;
  string recipient_email = 4;
  string recipient_first_name = 5;
  string recipient_last_name = 6;
  string sender_email = 7;
  string subject = 8;
}

message SendFormInvitationResponse {
  bool sent = 1;
  string prefilled_url = 2;
  string qr_code_url = 3;
  string message_id = 4;
  string provider = 5;
}

message IngestProviderWebhookRequest {
  string provider = 1;
  string event_name = 2;
  string external_event_id = 3;
  string payload_json = 4;
  map<string, string> headers = 5;
}

message IngestProviderWebhookResponse {
  bool accepted = 1;
  bool duplicate = 2;
  string event_id = 3;
  string provider = 4;
  string event_name = 5;
}

message WebhookEventSummary {
  string id = 1;
  string provider = 2;
  string event_name = 3;
  string external_event_id = 4;
  string status = 5;
  int32 attempts = 6;
  string created_at = 7;
  string processed_at = 8;
  string error_message = 9;
}

message ListWebhookEventsRequest {
  string provider = 1;
  int32 limit = 2;
}

message ListWebhookEventsResponse {
  repeated WebhookEventSummary events = 1;
}
